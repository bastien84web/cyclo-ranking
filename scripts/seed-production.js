// Script de peuplement pour la production
// Ce script sera ex√©cut√© apr√®s le d√©ploiement pour peupler la base PostgreSQL

const { PrismaClient } = require('@prisma/client')
const bcrypt = require('bcryptjs')

const prisma = new PrismaClient()

const realRaces = [
  // Courses mythiques
  {
    name: "L'√âtape du Tour",
    description: "Revivez l'exp√©rience du Tour de France sur une √©tape mythique. Parcours exigeant avec mont√©es l√©gendaires et paysages √† couper le souffle.",
    date: new Date('2025-07-13'),
    location: "Alpe d'Huez, France",
    distance: "138 km",
    website: "https://www.letapedutour.com"
  },
  {
    name: "La Marmotte",
    description: "L'une des cyclosportives les plus prestigieuses des Alpes. 4 cols mythiques : Glandon, T√©l√©graphe, Galibier et Alpe d'Huez.",
    date: new Date('2025-07-05'),
    location: "Bourg d'Oisans, France",
    distance: "174 km",
    website: "https://www.lamarmotte.fr"
  },
  {
    name: "Paris-Roubaix Challenge",
    description: "Sur les traces des coureurs professionnels, d√©couvrez l'enfer du Nord et ses pav√©s l√©gendaires.",
    date: new Date('2025-04-13'),
    location: "Compi√®gne, France",
    distance: "170 km",
    website: "https://www.parisroubaixchallenge.fr"
  },
  {
    name: "La Purito Andorra",
    description: "Cyclosportive de montagne en Andorre avec des paysages pyr√©n√©ens exceptionnels. Parcours vallonn√© et technique.",
    date: new Date('2025-08-24'),
    location: "Andorre-la-Vieille, Andorre",
    distance: "125 km",
    website: "https://www.puritoandorra.com"
  },
  {
    name: "L'Ard√©choise",
    description: "La plus grande cyclosportive de France ! D√©couvrez les routes sinueuses et les paysages sauvages de l'Ard√®che.",
    date: new Date('2025-06-14'),
    location: "Saint-F√©licien, Ard√®che",
    distance: "145 km",
    website: "https://www.ardechoise.com"
  },
  {
    name: "La Quebrantahuesos",
    description: "Cyclosportive espagnole mythique dans les Pyr√©n√©es. Parcours exigeant avec le col du Somport et des paysages grandioses.",
    date: new Date('2025-06-21'),
    location: "Sabi√±√°nigo, Espagne",
    distance: "200 km",
    website: "https://www.quebrantahuesos.com"
  },
  {
    name: "La Ventoux D√©nivel√© Challenge",
    description: "D√©fi ultime : gravir 3 fois le Mont Ventoux par ses 3 versants diff√©rents. Pour les plus courageux !",
    date: new Date('2025-06-08'),
    location: "B√©doin, Vaucluse",
    distance: "138 km",
    website: "https://www.ventouxdenivelechallenge.com"
  },
  {
    name: "La Cyclo du L√©man",
    description: "Tour du lac L√©man entre France et Suisse. Parcours roulant avec vues magnifiques sur le lac et les Alpes.",
    date: new Date('2025-05-25'),
    location: "Thonon-les-Bains, France",
    distance: "180 km",
    website: "https://www.cyclodulman.com"
  },
  {
    name: "La Granfondo Stelvio Santini",
    description: "Cyclosportive italienne l√©gendaire avec l'ascension du col du Stelvio, l'un des plus hauts cols routiers d'Europe.",
    date: new Date('2025-08-30'),
    location: "Bormio, Italie",
    distance: "151 km",
    website: "https://www.granfondostelvio.com"
  },
  {
    name: "La Dordogne Int√©grale",
    description: "Parcours vallonn√© √† travers les plus beaux villages du P√©rigord. Gastronomie et patrimoine au rendez-vous.",
    date: new Date('2025-09-07'),
    location: "Sarlat-la-Can√©da, Dordogne",
    distance: "120 km",
    website: "https://www.dordogneintegrale.fr"
  },
  {
    name: "La Haute Route Alpes",
    description: "√âtape de prestige dans les Alpes fran√ßaises. Cols mythiques et paysages alpins d'exception.",
    date: new Date('2025-08-16'),
    location: "Meg√®ve, Haute-Savoie",
    distance: "165 km",
    website: "https://www.hauteroute.org"
  },
  {
    name: "La Corsica Granfondo",
    description: "D√©couvrez la beaut√© sauvage de la Corse sur des routes sinueuses entre mer et montagne.",
    date: new Date('2025-05-11'),
    location: "Ajaccio, Corse",
    distance: "135 km",
    website: "https://www.corsicagranfondo.com"
  },
  {
    name: "La Dr√¥me Classic",
    description: "Cyclosportive dans la Dr√¥me proven√ßale. Lavande, vignobles et routes de caract√®re vous attendent.",
    date: new Date('2025-06-29'),
    location: "Nyons, Dr√¥me",
    distance: "110 km",
    website: "https://www.dromeclassic.fr"
  },
  {
    name: "La Fl√®che Wallonne Cyclo",
    description: "Sur les traces de la classique belge, avec l'ascension redoutable du Mur de Huy en point d'orgue.",
    date: new Date('2025-04-20'),
    location: "Huy, Belgique",
    distance: "98 km",
    website: "https://www.flechewallonnecyclo.be"
  },
  {
    name: "La Vuelta a Mallorca Cyclosportive",
    description: "Cyclosportive sur l'√Æle de Majorque avec des vues spectaculaires sur la M√©diterran√©e et la Serra de Tramuntana.",
    date: new Date('2025-03-30'),
    location: "Palma de Majorque, Espagne",
    distance: "155 km",
    website: "https://www.vueltamallorca.com"
  },
  
  // Nouvelles courses ajout√©es
  {
    name: "La Cyclo des Vins de Bourgogne",
    description: "Parcours vallonn√© √† travers les vignobles bourguignons. D√©gustation et patrimoine viticole au programme.",
    date: new Date('2025-09-14'),
    location: "Beaune, C√¥te-d'Or",
    distance: "95 km",
    website: "https://www.cyclobourgogne.fr"
  },
  {
    name: "La Mont√©e du Puy de D√¥me",
    description: "Ascension mythique du volcan auvergnat. Vue panoramique exceptionnelle sur la cha√Æne des Puys.",
    date: new Date('2025-06-08'),
    location: "Clermont-Ferrand, Puy-de-D√¥me",
    distance: "85 km",
    website: "https://www.puydedome-cyclo.fr"
  },
  {
    name: "La Transpyr√©n√©enne",
    description: "Travers√©e des Pyr√©n√©es de l'Atlantique √† la M√©diterran√©e. D√©fi sportif et paysages grandioses.",
    date: new Date('2025-08-02'),
    location: "Hendaye, Pyr√©n√©es-Atlantiques",
    distance: "720 km",
    website: "https://www.transpyrenenne.com"
  },
  {
    name: "La Cyclo du Luberon",
    description: "D√©couverte des villages perch√©s du Luberon. Lavande, vignes et patrimoine proven√ßal.",
    date: new Date('2025-06-15'),
    location: "Apt, Vaucluse",
    distance: "112 km",
    website: "https://www.cycloluberon.fr"
  },
  {
    name: "La Ronde des Ch√¢teaux de la Loire",
    description: "Circuit royal √† travers les plus beaux ch√¢teaux de la Loire. Histoire et gastronomie fran√ßaise.",
    date: new Date('2025-05-18'),
    location: "Blois, Loir-et-Cher",
    distance: "130 km",
    website: "https://www.chateauxloire-cyclo.fr"
  },
  {
    name: "La Granfondo del Gavia",
    description: "Cyclosportive italienne avec l'ascension du col du Gavia dans les Alpes lombardes.",
    date: new Date('2025-07-27'),
    location: "Bormio, Italie",
    distance: "168 km",
    website: "https://www.granfondogavia.it"
  },
  {
    name: "La Cyclo des Gorges du Verdon",
    description: "Parcours spectaculaire autour du Grand Canyon du Verdon. Falaises et eaux turquoise.",
    date: new Date('2025-09-07'),
    location: "Castellane, Alpes-de-Haute-Provence",
    distance: "140 km",
    website: "https://www.verdon-cyclo.fr"
  },
  {
    name: "La Mont√©e de l'Alpe d'Huez",
    description: "Ascension mythique des 21 lacets de l'Alpe d'Huez. Temple du cyclisme mondial.",
    date: new Date('2025-07-12'),
    location: "Bourg d'Oisans, Is√®re",
    distance: "55 km",
    website: "https://www.alpedhuez-cyclo.fr"
  },
  {
    name: "La Cyclo de la C√¥te d'Azur",
    description: "De Nice √† Monaco par la corniche. Mer M√©diterran√©e et villages perch√©s.",
    date: new Date('2025-04-27'),
    location: "Nice, Alpes-Maritimes",
    distance: "145 km",
    website: "https://www.cotedazur-cyclo.fr"
  },
  {
    name: "La Velothon Berlin",
    description: "Cyclosportive urbaine dans la capitale allemande. Histoire et modernit√© berlinoise.",
    date: new Date('2025-06-01'),
    location: "Berlin, Allemagne",
    distance: "120 km",
    website: "https://www.velothon-berlin.de"
  },
  {
    name: "La Cyclo des Volcans d'Auvergne",
    description: "Circuit √† travers le Parc des Volcans. Paysages volcaniques uniques en Europe.",
    date: new Date('2025-08-24'),
    location: "Le Lioran, Cantal",
    distance: "155 km",
    website: "https://www.volcans-cyclo.fr"
  },
  {
    name: "La Cyclo du Mont-Blanc",
    description: "Tour du massif du Mont-Blanc entre France, Suisse et Italie. Haute montagne et glaciers.",
    date: new Date('2025-08-16'),
    location: "Chamonix, Haute-Savoie",
    distance: "165 km",
    website: "https://www.montblanc-cyclo.fr"
  },
  {
    name: "La Ronde Picarde",
    description: "D√©couverte de la Picardie historique. Cath√©drales gothiques et champs de bataille.",
    date: new Date('2025-05-11'),
    location: "Amiens, Somme",
    distance: "98 km",
    website: "https://www.rondepicarde.fr"
  },
  {
    name: "La Cyclo des Causses",
    description: "Plateaux calcaires et gorges profondes. Paysages sauvages du sud du Massif Central.",
    date: new Date('2025-06-29'),
    location: "Millau, Aveyron",
    distance: "125 km",
    website: "https://www.causses-cyclo.fr"
  },
  {
    name: "La Cyclo des Ch√¢teaux Cathares",
    description: "Sur les traces des Cathares dans l'Aude. Ch√¢teaux perch√©s et histoire m√©di√©vale.",
    date: new Date('2025-09-21'),
    location: "Carcassonne, Aude",
    distance: "135 km",
    website: "https://www.cathares-cyclo.fr"
  },
  {
    name: "La Granfondo Campagnolo Roma",
    description: "Cyclosportive dans la campagne romaine. Patrimoine antique et collines du Latium.",
    date: new Date('2025-03-30'),
    location: "Rome, Italie",
    distance: "142 km",
    website: "https://www.granfondoroma.it"
  }
]

async function main() {
  console.log('üå± D√©but du peuplement de la base de production...')

  // Cr√©er un utilisateur admin
  const hashedPassword = await bcrypt.hash('admin123', 10)
  
  const adminUser = await prisma.user.upsert({
    where: { email: 'admin@cycloranking.com' },
    update: {},
    create: {
      email: 'admin@cycloranking.com',
      name: 'Administrateur',
      password: hashedPassword,
      emailVerified: new Date(),
    },
  })

  console.log('üë§ Utilisateur admin cr√©√©:', adminUser.email)

  // Cr√©er les cyclosportives
  let createdCount = 0
  for (const raceData of realRaces) {
    const existingRace = await prisma.race.findFirst({
      where: { name: raceData.name }
    })
    
    if (!existingRace) {
      const race = await prisma.race.create({
        data: {
          ...raceData,
          createdBy: adminUser.id,
        },
      })
      console.log(`üö¥ Course cr√©√©e: ${race.name}`)
      createdCount++
    }
  }

  console.log(`‚úÖ ${createdCount} nouvelles cyclosportives cr√©√©es en production!`)
  console.log(`üìä Total: ${realRaces.length} cyclosportives disponibles`)
}

main()
  .catch((e) => {
    console.error('‚ùå Erreur:', e)
    process.exit(1)
  })
  .finally(async () => {
    await prisma.$disconnect()
  })
